{% extends "base.html" %}
{% load staticfiles %}
{% load user_text %}

{% block content %}
  <div class="container welcome">
    <form action="trials/" method="GET">
      <div class="row">
        <div class="col-sm-12">
          <h3>Search for open clinical trials for colorectal cancer</h3>
        </div>
      </div>
      <div class="row welcome-filters">
        <div class="col-sm-4">
          <!--
          <h5>Type of cancer</h5>
          <div class="checkbox">
            <label><input type="checkbox" value="colon">Colon cancer</label>
          </div>
          <div class="checkbox">
            <label><input type="checkbox" value="rectal">Rectal cancer</label>
          </div>
          <div class="checkbox">
            <label><input type="checkbox" value="colorectal" disabled>Colorectal</label>
          </div>
          -->
          <h5>Geography</h5>
          <div class="checkbox">
            <select id="geo" name="location" style="width: 150px"></select>
          </div>
        </div>
        <div class="col-sm-4">
          <h5>Type of treatment</h5>
          <div class="radio">
            <label><input type="radio" name="treatmentType" value="immunotherapy">Immunotherapy only</label>
          </div>
          <div class="radio">
            <label><input type="radio" name="treatmentType" value="all">All</label>
          </div>
          <h5>Prior immunotherapy</h5>
          <div class="checkbox">
            <label><input type="checkbox" name="priorIo" value="yes">Allowed</label>
          </div>
        </div>
        <div class="col-sm-4">
          <h5>Advanced search</h5>
          <div class="form-group">
            <!-- type-ahead? -->
            <input type="text" class="form-control" name="nctNumber" placeholder="NCT number" id="adv-nct">
          </div>
          <div class="form-group">
            <input type="text" class="form-control" name="therapyName" placeholder="Therapy Name" id="adv-therapy">
          </div>
          <div class="form-group">
            <input type="text" class="form-control" name="searchTerm" placeholder="Search any text" id="adv-texty">
          </div>
        </div>
      </div>
      <div class="row centered">
        <div class="col-sm-2 col-md-offset-5">
          <button class="btn btn-primary" type="submit">Search</button>
        </div>
      </div>
    </form>
  </div>

  <script type="text/javascript">
    var trials = {{ trials|safe }};
    var locations = _.uniq(_.flatten(_.map(trials.data, function(item) { return item[4]; }))).sort();

    var geoSelect = $('#geo');
    _.forEach(locations, function(location) {
      geoSelect.append($('<option/>', {value: location, text: location}));
    });
  </script>
{% endblock %}
